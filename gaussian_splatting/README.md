Adapted from https://github.com/hbb1/torch-splatting